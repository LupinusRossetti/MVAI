"""
服装選択のロジックと選択肢定義
"""

from typing import Dict, List, Optional, Tuple


class OutfitSelector:
    """服装選択のロジック管理クラス"""
    
    # 上に着るもの（トップス）
    TOPS = [
        "Tシャツ", "長袖Tシャツ", "半袖シャツ", "長袖シャツ", "ブラウス", "ポロシャツ",
        "タンクトップ", "キャミソール", "ノースリーブ", "チューブトップ", "ベアトップ",
        "セーター", "カーディガン", "ニット", "パーカー", "フーディー",
        "タートルネック", "ハイネック", "Vネック", "Uネック", "オフショルダー",
        "ワンピース（上部分）", "チュニック", "ブラウス（レース）", "ブラウス（リボン）",
        "ブラウス（フリル）", "ブラウス（ボタン）", "ブラウス（開襟）", "ブラウス（高襟）",
        "タンクトップ（レース）", "タンクトップ（フリル）", "キャミソール（レース）",
        "キャミソール（フリル）", "セーター（カーディガン）", "セーター（Vネック）",
        "セーター（タートルネック）", "ニット（カーディガン）", "ニット（Vネック）",
        "パーカー（フード付き）", "パーカー（フードなし）", "フーディー（ジッパー）",
        "フーディー（プルオーバー）", "その他（上着）"
    ]
    
    # 下にはくもの（ボトムス）
    BOTTOMS = [
        "ジーンズ", "スキニージーンズ", "ワイドパンツ", "カーゴパンツ", "チノパン",
        "スラックス", "パンツ", "ショートパンツ", "ハーフパンツ", "ホットパンツ",
        "スカート", "ミニスカート", "ロングスカート", "フレアスカート", "タイトスカート",
        "プリーツスカート", "ギャザースカート", "マキシスカート", "パンツスカート",
        "ジーンズ（スキニー）", "ジーンズ（ストレート）", "ジーンズ（ワイド）",
        "スラックス（ストレート）", "スラックス（テーパード）", "スラックス（ワイド）",
        "パンツ（ストレート）", "パンツ（テーパード）", "パンツ（ワイド）",
        "ショートパンツ（デニム）", "ショートパンツ（カーゴ）", "ショートパンツ（チノ）",
        "スカート（ミニ）", "スカート（ロング）", "スカート（フレア）",
        "スカート（タイト）", "スカート（プリーツ）", "スカート（ギャザー）",
        "スカート（マキシ）", "スカート（パンツ）", "その他（下着）"
    ]
    
    # 上下合わさっているもの（ワンピース・ドレス）
    ONEPIECE = [
        "ワンピース", "ドレス", "サンドレス", "キャミワンピース", "チュニックワンピース",
        "ロングドレス", "ミニドレス", "マキシドレス", "フレアドレス", "タイトドレス",
        "プリーツドレス", "ギャザードレス", "レースドレス", "フリルドレス",
        "リボンドレス", "ボタンドレス", "ジッパードレス", "Vネックドレス",
        "オフショルダードレス", "ストラップレスドレス", "ハイネックドレス",
        "タートルネックドレス", "ワンピース（カジュアル）", "ワンピース（フォーマル）",
        "ワンピース（エレガント）", "ワンピース（カワイイ）", "ワンピース（シンプル）",
        "ドレス（カジュアル）", "ドレス（フォーマル）", "ドレス（エレガント）",
        "ドレス（カワイイ）", "ドレス（シンプル）", "サンドレス（ストラップ）",
        "サンドレス（オフショルダー）", "サンドレス（ハルター）", "キャミワンピース（レース）",
        "キャミワンピース（フリル）", "チュニックワンピース（ロング）",
        "チュニックワンピース（ミディ）", "その他（ワンピース）"
    ]
    
    # 上着・アウター
    OUTERWEAR = [
        "ジャケット", "ブルゾン", "ダウンジャケット", "レザージャケット", "デニムジャケット",
        "トレンチコート", "コート", "ロングコート", "ショートコート", "ピーコート",
        "チェスターコート", "ダッフルコート", "パーカ", "ウィンドブレーカー",
        "アノラック", "カーディガン", "ボレロ", "ベスト", "ジレ",
        "ジャケット（デニム）", "ジャケット（レザー）", "ジャケット（スーツ）",
        "ジャケット（カジュアル）", "ブルゾン（ナイロン）", "ブルゾン（コットン）",
        "ダウンジャケット（ロング）", "ダウンジャケット（ショート）",
        "レザージャケット（バイカー）", "レザージャケット（ライダー）",
        "トレンチコート（ロング）", "トレンチコート（ショート）",
        "コート（ロング）", "コート（ショート）", "コート（ウール）",
        "コート（ダッフル）", "コート（チェスター）", "パーカ（フード付き）",
        "パーカ（フードなし）", "ウィンドブレーカー（ロング）",
        "ウィンドブレーカー（ショート）", "アノラック（フード付き）",
        "アノラック（フードなし）", "カーディガン（ロング）",
        "カーディガン（ショート）", "ボレロ（ショート）", "ベスト（ウール）",
        "ベスト（デニム）", "ベスト（レザー）", "ジレ（ウール）",
        "ジレ（コットン）", "その他（上着）"
    ]
    
    # インナー
    INNERWEAR = [
        "ブラ", "キャミソール", "タンクトップ", "ランニングシャツ", "アンダーシャツ",
        "インナー（長袖）", "インナー（半袖）", "インナー（ノースリーブ）",
        "インナー（レース）", "インナー（シンプル）", "その他（インナー）"
    ]
    
    # 靴下
    SOCKS = [
        "ソックス", "ショートソックス", "ロングソックス", "ニーソックス", "オーバーニーソックス",
        "タイツ", "パンスト", "レギンス", "ストッキング", "ソックス（無地）",
        "ソックス（柄付き）", "ソックス（レース）", "ソックス（フリル）",
        "ショートソックス（無地）", "ショートソックス（柄付き）",
        "ロングソックス（無地）", "ロングソックス（柄付き）",
        "ニーソックス（無地）", "ニーソックス（柄付き）",
        "オーバーニーソックス（無地）", "オーバーニーソックス（柄付き）",
        "タイツ（黒）", "タイツ（肌色）", "タイツ（柄付き）",
        "パンスト（黒）", "パンスト（肌色）", "パンスト（柄付き）",
        "レギンス（黒）", "レギンス（柄付き）", "ストッキング（黒）",
        "ストッキング（肌色）", "その他（靴下）"
    ]
    
    # 靴
    SHOES = [
        "スニーカー", "ハイカットスニーカー", "ローカットスニーカー", "スラッシュスニーカー",
        "パンプス", "ハイヒール", "ローヒール", "フラットシューズ", "サンダル",
        "ブーツ", "ロングブーツ", "ショートブーツ", "アンクルブーツ",
        "モカシン", "ローファー", "オックスフォード", "ドレスシューズ",
        "スニーカー（白）", "スニーカー（黒）", "スニーカー（カラフル）",
        "ハイカットスニーカー（白）", "ハイカットスニーカー（黒）",
        "ローカットスニーカー（白）", "ローカットスニーカー（黒）",
        "パンプス（黒）", "パンプス（白）", "パンプス（カラフル）",
        "ハイヒール（黒）", "ハイヒール（白）", "ハイヒール（レッド）",
        "ローヒール（黒）", "ローヒール（白）", "フラットシューズ（黒）",
        "フラットシューズ（白）", "サンダル（ストラップ）", "サンダル（ビーチ）",
        "ブーツ（ロング）", "ブーツ（ショート）", "ブーツ（アンクル）",
        "モカシン（ブラウン）", "モカシン（ブラック）", "ローファー（ブラウン）",
        "ローファー（ブラック）", "オックスフォード（ブラウン）",
        "オックスフォード（ブラック）", "ドレスシューズ（ブラウン）",
        "ドレスシューズ（ブラック）", "その他（靴）"
    ]
    
    # マント・ストールなどの羽織るもの
    WRAPS = [
        "マント", "ケープ", "ストール", "ショール", "パシュミナ",
        "スカーフ", "スヌード", "ボア", "ファー", "ポンチョ",
        "マント（ロング）", "マント（ショート）", "マント（フード付き）",
        "ケープ（ロング）", "ケープ（ショート）", "ストール（長）",
        "ストール（短）", "ストール（レース）", "ストール（フリル）",
        "ショール（長）", "ショール（短）", "パシュミナ（長）",
        "パシュミナ（短）", "スカーフ（正方形）", "スカーフ（長方形）",
        "スヌード（太）", "スヌード（細）", "ボア（ショート）",
        "ボア（ロング）", "ファー（ショート）", "ファー（ロング）",
        "ポンチョ（フード付き）", "ポンチョ（フードなし）", "その他（羽織るもの）"
    ]
    
    # アクセサリー
    ACCESSORIES = [
        "ネックレス", "ペンダント", "チョーカー", "イヤリング", "ピアス",
        "ブレスレット", "腕時計", "指輪", "リング", "ブローチ",
        "バッグ", "ハンドバッグ", "ショルダーバッグ", "リュック", "トートバッグ",
        "帽子", "キャップ", "ハット", "ベレー帽", "ニット帽",
        "サングラス", "眼鏡", "マスク", "手袋", "ミトン",
        "ネックレス（ゴールド）", "ネックレス（シルバー）", "ネックレス（パール）",
        "ペンダント（ゴールド）", "ペンダント（シルバー）", "チョーカー（ゴールド）",
        "チョーカー（シルバー）", "イヤリング（ゴールド）", "イヤリング（シルバー）",
        "ピアス（ゴールド）", "ピアス（シルバー）", "ブレスレット（ゴールド）",
        "ブレスレット（シルバー）", "腕時計（レザー）", "腕時計（メタル）",
        "指輪（ゴールド）", "指輪（シルバー）", "リング（ゴールド）",
        "リング（シルバー）", "ブローチ（ゴールド）", "ブローチ（シルバー）",
        "バッグ（レザー）", "バッグ（ナイロン）", "ハンドバッグ（レザー）",
        "ハンドバッグ（ナイロン）", "ショルダーバッグ（レザー）",
        "ショルダーバッグ（ナイロン）", "リュック（ナイロン）", "リュック（レザー）",
        "トートバッグ（キャンバス）", "トートバッグ（レザー）",
        "帽子（キャップ）", "帽子（ハット）", "帽子（ベレー）",
        "帽子（ニット）", "サングラス（黒）", "サングラス（カラフル）",
        "眼鏡（黒）", "眼鏡（カラフル）", "マスク（布）", "マスク（不織布）",
        "手袋（レザー）", "手袋（ニット）", "ミトン（レザー）",
        "ミトン（ニット）", "その他（アクセサリー）"
    ]
    
    # 服の柄
    PATTERNS = [
        "無地", "ストライプ", "チェック", "ドット", "フラワー", "ポルカドット",
        "ギンガムチェック", "タータンチェック", "千鳥格子", "ペイズリー",
        "アニマルプリント", "レオパード", "ゼブラ", "タイガー", "スネーク",
        "幾何学模様", "三角形", "四角形", "円形", "星形", "ハート",
        "水玉", "大玉", "小玉", "中玉", "花柄", "バラ", "桜", "ひまわり",
        "リボン", "リボン柄", "レース", "レース柄", "フリル", "フリル柄",
        "ボタン", "ボタン柄", "ジッパー", "ジッパー柄", "その他（柄）"
    ]
    
    @staticmethod
    def get_outfit_categories() -> Dict[str, List[str]]:
        """服装カテゴリと選択肢を取得"""
        return {
            "tops": OutfitSelector.TOPS,
            "bottoms": OutfitSelector.BOTTOMS,
            "onepiece": OutfitSelector.ONEPIECE,
            "outerwear": OutfitSelector.OUTERWEAR,
            "innerwear": OutfitSelector.INNERWEAR,
            "socks": OutfitSelector.SOCKS,
            "shoes": OutfitSelector.SHOES,
            "wraps": OutfitSelector.WRAPS,
            "accessories": OutfitSelector.ACCESSORIES,
            "patterns": OutfitSelector.PATTERNS
        }
    
    @staticmethod
    def can_select_category(selected_categories: Dict[str, str]) -> Dict[str, bool]:
        """選択可能なカテゴリを判定"""
        can_select = {
            "tops": True,
            "bottoms": True,
            "onepiece": True,
            "outerwear": True,
            "innerwear": True,
            "socks": True,
            "shoes": True,
            "wraps": True,
            "accessories": True,
            "patterns": True
        }
        
        # ワンピースを選んだら、トップスとボトムスは選択不可
        if selected_categories.get("onepiece"):
            can_select["tops"] = False
            can_select["bottoms"] = False
        
        # トップスとボトムスを選んだら、ワンピースは選択不可
        if selected_categories.get("tops") or selected_categories.get("bottoms"):
            can_select["onepiece"] = False
        
        return can_select

